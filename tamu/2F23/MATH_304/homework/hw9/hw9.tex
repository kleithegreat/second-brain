\documentclass{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{fancyhdr}
\usepackage{enumerate}

\pagestyle{fancy}
\fancyhf{}
\lhead{9th Homework - MATH 304 508}
\rhead{Kevin Lei}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\arraystretch}{1.2}

\begin{document}

\section*{Question 1}
Consider the vectors $\{x_1, x_2, x_3\}$ of $\mathbb{R}^4$ where
$$ x_1 = (4, 2, 2, 1)^T, \; x_2 = (2, 0, 0, 2)^T, \; x_3 = (1, 1, -1 ,1)^T $$
Let $S := \text{span} \{x_1, x_2, x_3\}$.
Use the Gram-Schmidt process to obtain an orthonormal basis for $S$.

\vspace{0.5cm}
\noindent\textbf{Solution:}
\begin{align*}
    u_1 &= \frac{x_1}{\|x_1\|_2} = \frac{1}{5} (4, 2, 2, 1)^T \\
    p_1 &= \langle x_2, u_1 \rangle u_1 = \frac{1}{5} \times 10 \times \frac{1}{5} (4, 2, 2, 1)^T = \frac{2}{5} (4, 2, 2, 1)^T \\
\end{align*}

\section*{Question 2}
Find the orthogonal complement of the subspace of $\mathbb{R}^3$ spanned by $(1, 2, 1)^T$, $(1, -1, 2)^T$.

\vspace{0.5cm}
\noindent\textbf{Solution:}
Given the subspace $S := \text{span} \{(1, 2, 1)^T, (1, -1, 2)^T\}$, we want to find the orthogonal complement $S^\perp$.
The orthogonal complement is the set of all vectors in the vector space that are orthogonal to every vector in $S$.
Thus, by definition, we have
$$ S^\perp = \left\{
    \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} 
    \; \middle| \; 
    \left\langle \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix}, \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix} \right\rangle = 0 
    \; , \; 
    \left\langle \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix}, \begin{pmatrix} 1 \\ -1 \\ 2 \end{pmatrix} \right\rangle = 0
\right\} $$

To find $x_1, x_2, x_3$, we can solve the system of equations
\begin{align*}
    &\begin{cases}
        x_1 + 2x_2 + x_3 = 0 \\
        x_1 - x_2 + 2x_3 = 0
    \end{cases} \\
    &\sim
    \left(\begin{array}{ccc|c} 
        1 & 2 & 1 & 0 \\
        1 & -1 & 2 & 0 
    \end{array}\right) \sim
    \left(\begin{array}{ccc|c} 
        1 & 2 & 1 & 0 \\
        0 & -3 & 1 & 0
    \end{array}\right) \sim
    \left(\begin{array}{ccc|c} 
        1 & 2 & 1 & 0 \\
        0 & 1 & -\frac{1}{3} & 0
    \end{array}\right) \sim
    \left(\begin{array}{ccc|c} 
        1 & 0 & \frac{5}{3} & 0 \\
        0 & 1 & -\frac{1}{3} & 0
    \end{array}\right) \\ &\sim
    \begin{cases}
        x_1 = -\frac{5}{3}x_3 \\
        x_2 = \frac{1}{3}x_3
    \end{cases}
\end{align*}

Thus, we have
$$ S^\perp = \left\{
    \begin{pmatrix} -\frac{5}{3}x_3 \\ \frac{1}{3}x_3 \\ x_3 \end{pmatrix} 
    \; \middle| \; 
    x_3 \in \mathbb{R}
\right\} = \text{span} \left\{
    \begin{pmatrix} -\frac{5}{3} \\ \frac{1}{3} \\ 1 \end{pmatrix}
\right\} $$

\section*{Question 3}
Let $A$ be an $m \times n$ matrix.
Show that $A$ and $A^TA$ have the same rank.
Show that $$ N(A^T A) = N(A) $$

\vspace{0.5cm}
\noindent\textbf{Solution:}
\begin{proof}
    We have that $A$ is an $m \times n$ matrix.
    To show that $N(A^T A) = N(A)$, we need to show that $N(A^T A) \subseteq N(A)$ and $N(A) \subseteq N(A^T A)$.
    Let $x \in N(A)$.
    By definition of the null space, we have $Ax = 0$.
    Then we have $A^T A x = A^T 0 = 0$.
    Again, by definition of the null space, we have $x \in N(A^T A)$.
    Since $x \in N(A) \implies x \in N(A^T A)$, we have $N(A) \subseteq N(A^T A)$.
    Now let $x \in N(A^T A)$.
    By definition of the null space, $A^T A x = A^T (A x) = 0$.
    Therefore, $Ax \in N(A^T)$.
    However, $Ax$ is also in the column space of $A$, which means $Ax \in R(A)$.
    The Fundamental Theorem of Linear Algebra tells us that $N(A^T) \perp R(A)$.
    This means that % some intersection shit implies x = 0
\end{proof}

\section*{Question 4}
Let $A$ be an $m \times n$ matrix and rank($A$) = $r$.
What are the dimensions of $N(A)$ and $N(A^T)$?

\vspace{0.5cm}
\noindent\textbf{Solution:}
By the rank-nullity theorem, we know that $\text{rank}(A) \; + \; \text{nullity}(A) = n$.
Thus, we have
$$ \text{nullity}(A) = n - \text{rank}(A) = n - r $$
Since taking the transpose of a matrix does not change the number of linearly independent rows or columns,
$A$ and $A^T$ have the same rank.
Therefore,
$$ \text{nullity}(A^T) = m - \text{rank}(A^T) = m - r $$

\section*{Question 5}
For each of the following systems $Ax = b$ find all least squares solutions.
$$
A = \begin{pmatrix} 1 & 1 \\ 3 & 4 \\ -1 & 0 \end{pmatrix}, \; b = \begin{pmatrix} 0 \\ 1 \\ -1 \end{pmatrix}, \; \text{and} \;
A = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 1 & 2 \\ 2 & 2 & 1 \end{pmatrix}, \; b = \begin{pmatrix} 2 \\ 1 \\ 1 \\ 0 \end{pmatrix}
$$

\vspace{0.5cm}
\noindent\textbf{Solution:} According to the Least Squares Theorem, the solution to the least squares problem is given by
the solution to the normal equations 
$$ A^T A \hat{x} = A^T b $$
where $\hat{x}$ is the least squares solution.
If $A$ has full rank, then $A^T A$ is invertible and the solution is given by
$$ \hat{x} = (A^T A)^{-1} A^T b $$
For the first system, we can do the following:
\begin{align*}
    \hat{x} &= \left( \begin{pmatrix} 1 & 3 & -1 \\ 1 & 4 & 0 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 3 & 4 \\ -1 & 0 \end{pmatrix} \right)^{-1} \begin{pmatrix} 1 & 3 & -1 \\ 1 & 4 & 0 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \\ -1 \end{pmatrix} \\
    &= \left( \begin{matrix} 11 & 13 \\ 13 & 17 \end{matrix} \right)^{-1} \begin{pmatrix} 4 \\ 4 \end{pmatrix} \\
    &= \frac{1}{18} \begin{pmatrix} 17 & -13 \\ -13 & 11 \end{pmatrix} \begin{pmatrix} 4 \\ 4 \end{pmatrix} \\
    &= \begin{pmatrix} \frac{8}{9} \\ \frac{-4}{9} \end{pmatrix}
\end{align*}
For the second system, we have:
\begin{align*}
    \hat{x} &= \left( \begin{pmatrix} 1 & 0 & 0 & 2 \\ 1 & 0 & 1 & 2 \\ 0 & 1 & 2 & 1 \end{pmatrix} \begin{pmatrix} 1 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 1 & 2 \\ 2 & 2 & 1 \end{pmatrix} \right)^{-1} \begin{pmatrix} 1 & 0 & 0 & 2 \\ 1 & 0 & 1 & 2 \\ 0 & 1 & 2 & 1 \end{pmatrix} \begin{pmatrix} 2 \\ 1 \\ 1 \\ 0 \end{pmatrix} \\
    &= \left( \begin{matrix} 5 & 5 & 2 \\ 5 & 6 & 4 \\ 2 & 4 & 6 \end{matrix} \right)^{-1} \begin{pmatrix} 2 \\ 3 \\ 3 \end{pmatrix} \\
    &= \frac{1}{6} \begin{pmatrix} 20 & -22 & 8 \\ -22 & 26 & -10 \\ 8 & -10 & 5 \end{pmatrix} \begin{pmatrix} 2 \\ 3 \\ 3 \end{pmatrix} \\
    &= \begin{pmatrix} \frac{-1}{3} \\ \frac{2}{3} \\ \frac{1}{6} \end{pmatrix}
\end{align*}

\section*{Question 6}
Consider the basis $\{x_1, x_2, x_3\}$ of $\mathbb{R}^3$ where
$$ x_1 = (1, 2, -2)^T, \; x_2 = (4, 3, 2)^T, \; x_3 = (1, 2, 1)^T $$
Use the Gram-Schmidt process to obtain an orthonormal basis.

\vspace{0.5cm}
\noindent\textbf{Solution:}

\end{document}
